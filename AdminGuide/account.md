# 2 账号认证

账号认证服务为云平台提供账号及权限体系，支撑整个平台的用户账号接入及多租户管理。针对租户控制台和管理控制台两种场景，平台分别提供管理员账号和租户管理服务对平台及资源进行认证管理。

## 2.1 管理员账号

管理员 `admin` 账号是管理员控制台账号，拥有平台所有管理权限，用于全局管理和运营整个云平台。可通过管理员账号管理云平台的地域、集群、租户、资源、计费、审批、安全及平台全局配置。

作为平台管理员账号，拥有平台最高权限，针对管理员账号自身的安全平台提供修改登录密码、找回密码、双因子验证登录、登录访问限制、修改登录邮箱等安全防护功能；同时支持获取 Admin 管理员的 API 密钥信息，用于通过 API 接口查询平台全局资源及运行信息。

> 平台账号体系目前均使用邮箱地址作为平台的登录账号，在使用前需确保提供的账号邮箱地址可用，方便接收告警邮件或找回密码等。

平台默认使用 `admin@ucloud.cn` 邮箱地址作为平台的管理员账号，使用 admin 账号登录控制台即会自动登入管理员控制台，使用其它账号登录控制台会自动登录入租户控制台。

### 2.1.1 修改登录密码

在使用 admin 账号时，若需要更改管理员密码，可通过管理员控制台右上角管理员账号头像中的【修改登录密码】进行修改。修改密码时需要提供当前登录密码，确认当前登录密码无误后，即可完成账号的密码修改。

如果忘记当前登录密码，可通过【找回密码】功能重设 admin 账号的密码，避免无法登录控制台。

### 2.1.2 找回密码

平台支持管理员账号在忘记密码时通过控制台自主找回密码，找回密码时需通过邮箱进行验证，需确保管理员添加的账号为真实可用的邮箱。通过登录⻚面的【找回密码】功能，即可使用邮箱地址验证􏰀为账号设置新密码。

􏰀置密码成功后，即可使用最新设置的密码登录云平台，进行云平台资源的运营和管理。

### 2.1.3 双因子验证登录

平台为 admin 账号提供免费的基于 TOTP（Time-Based One-Time Password Algorithm）登录二次认证服务，开通本服务后，管理员每次登录控制台均需通过授权认证。 为降低账号密码泄漏造成的风险，建议您开通账号登录，开通步骤始下：

1. 登录控制台并进入账号控制台，通过管理员头像中的【开启登录保护】进行操作，如下图所示：

   ![loginprotect](/images/adminguide/loginprotect.png)

2. 检查移动设备上是否安装 FortiToken ：

- 页面提供 IOS 和 Android 用户工具下载地址，若您未安装 FortiToken 可通过扫码下载。
- 安卓手机用户也可以通过手机品牌商提供的应用商店搜索和下载 FortiToken 。

3. 打开 FortiToken 工具，扫码获取授权码，也可手动输入密钥获取授权码。

4. 在页面方框内输入获取到的授权码，完成绑定。

开启双因子验证后，管理员账号每次登录控制台均需通过二次认证。登录时在输入账号密码后，需要额外再输入授权码后才可成功登录账号，如下图所示：

![fortitoken](/images/adminguide/fortitokenlogin.png)

可登录控制台点击管理员账号头像中的【关闭登录保证】，输入 6 位授权码，即可关闭双因子验证功能。

### 2.1.4 登录访问限制

为保证账号登录的安全及对特定安全场景的需求，平台提供账号登录访问限制能力，为管理员账号设置登录控制台和访问 API 的客户端 IP 地址，配置后管理员账号只能从指定的 IP 登录或发起 API 访问，保证管理员登录及资源管理的安全性。

* 支持配置多个 IP 地址或 IP 地址段，多个 IP 地址/段间使用英文逗号进行分隔。
* 配置的 IP 地址 或 IP 地址段为白名单模式，即配置的 IP 地址/段客户端才可正常登录控制台或访问 API 。
* 默认不指定任何 IP ，代表不限制登录控制台和访问 API 的客户端 IP 地址，即默认全网可访问登录控制台。

> 为保证管理员账号可正常登录控制台，设置时需保证至少有一段可通达的地址配置在登录访问范围内，否则可能导致无法登录管理。

管理员可通过头像操作中的【登录访问限制】功能进行登录策略配置，如下图所示，默认为空代表全网无限制。

![LoginWhitelist](/images/adminguide/LoginWhitelist.png)

可在登录访问范围内输入可登录平台的 IP 地址或 IP 地址段，点击确认即可生效。配置成功后，管理员账号在未指定的 IP 网络中无法正常登录控制台，并提示当前的 IP 地址，如下图所示：

![LoginWhitelist1](/images/adminguide/LoginWhitelist1.png)

平台仅可限制访问控制台的 IP 地址，即直接请求到控制台 URL 地址的客户端 IP 地址，如用户使用管理员账号访问平台的客户端地址在 NAT 路由内，则平台配置登录策略时，需要放通 NAT 后的 IP 地址，即需要将 NAT 后的出口地址配置在登录访问策略的白名单中，保证 NAT 路由器内的客户端均可正常访问控制台。

### 2.1.5 修改登录邮箱

平台支持管理员修改管理员的账号邮箱地址，用于将管理员账号修改为真实可用且实际需要接收告警邮件的邮箱地址，具体修改操作如下图所示：

![updateadminemail](/images/adminguide/updateadminemail.png)

管理员修登录邮箱修改后可使用原有密码登录控制台，可通过修改登录密码重置管理员邮箱密码。

### 2.1.6 获取 API 密钥

支持开发者通过 admin 账号获取管理员账号的 API 密钥 ，用于使用平台管理的 API 接口 获取平台全局资源的信息，如下图所示：

![adminapisec](/images/adminguide/adminapisec.png)

可通过点击复制按钮进行公私密钥的信息复制，以方便 API 指令的调用。

## 2.2 租户 

平台支持多租户模式，用于有多级组架构构的企业，可将租户作为一个单独的公司进行运营，有效实现权限管理，除低总公司、子公司及不同部门资源混用可能造成的风险，并可实现资源审计。

租户是平台中一组资源的集合，提供资源隔离、子账号、权限控制、配额及价格配置等能力。不同租户间资源通过 VPC 网络及权限实现强隔离；租户内所有主账号和子账号的资源、费用、配额及审批均归属于租户。

租户可通过平台管理员创建或云平台进行注册，注册成功后需要管理员进行充值才可进行使用。平台管理员可全局对平台的所有租户进行全生命周期管理，包括创建租户、激活账号、修改名称、冻结、解冻、登录访问限制、开关审批流程，可对租户进行配额管理 、价格配置、账号充值及主子账管理，同时可全权查看租户的资源概览、订单信息、交易信息及充值信息，详见 [租户管理](#_7-租户管理) 。

