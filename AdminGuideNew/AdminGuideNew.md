# 管理员指南

#### 版权声明

版权所有 ©  优刻得科技股份有限公司 2020 保留一切权利。

非经本公司书面许可，任何单位和个人不得擅自摘抄、复制本文档内容的部分或全部，并不得以任何形式传播。

UCloudStack 商标和 UCloud 商标为优刻得科技股份有限公司所有。对于本手册中可能出现的其它公司的商标及产品标识，由各自权利人拥有。

注意您购买的产品、服务或特性等应受优刻得科技股份有限公司商业合同和条款约束，本文档中描述的全部或部分产品、服务或特性可能不在您的购买或使用权利范围之内。除非合同另有约定，优刻得科技股份有限公司对本文档内容不做任何明示或暗示的声明或保证。

由于产品版本升级或其它原因，本文档内容会不定期更新，除非另有约定，本文档仅作为使用指导，本文档中的所有陈述、信息和建议不构成任何明示或暗示的担保。

本文档描述 UCloudStack （v1.20.0）云平台的管理员功能说明和操作指南，适用于需要通过管理控制台管理并运营整个平台的资源、账户及相关配置的平台管理者和运营者，开发者可参考 API 开发者文档。

# 1 概述

UcloudStack管理后台是开放给企业云管理员、运维人员使用的管理后台，主要提供物理资源、虚拟资源管理、账户管理、流程审批、运维迁移等平台管理功能。

# 2 管理员账号

admin账号是UcloudStack云平台提供的默认管理账号，具有平台最高权限，可以对云平台所有区域的云数据中心进行物理资源管理、虚拟资源管理、平台运维及运营管理等相关操作。针对admin账号平台提供通用的账号管理和安全防护功能，包括修改登录密码、修改账号邮箱、找回密码、开启登录保护、登录访问限制，同时可以获取Admin账号的API 公钥和私钥信息。

## 2.1 修改登录密码

点击admin账号头像，选择“修改登录密码”操作，确认当前登录密码，输入和确认新密码后，可完成admin账号的修改。

##2.2 修改账号邮箱

点击admin账号头像，选择“修改登录邮箱”操作，输入新邮箱后，可完成admin账号邮箱的修改。

## 2.3 找回密码

平台支持admin账号在忘记密码时通过控制台自主找回密码，找回密码时需通过邮箱进行验证，请确保admin账号添加的账号为真实可用的邮箱。如果admin账号已设置的邮箱未无效邮箱，可通过2.2中修改账号邮箱操作更新。通过登录页面的【找回密码】功能，即可使用邮箱地址验证重新为admin账号设置新密码。

## 2.4 登陆保护

### 2.4.1开启登录保护

admin账号可使用平台提供免费的基于 TOTP（Time-Based One-Time Password Algorithm）登录二次认证服务。点击admin头像，选择“开启登录保护”操作。使用设备中事先下载好的的FortiToken应用，扫描获取授权码处的二维码，再输入FortiToken中展示的授权码后，点击确认，即可为admin账号开启账号登录保护功能。
![](loginprotect.png)

开通本服务后，admin账号每次登录控制台均需通过授权认证。 为了降低admin账号密码泄漏造成的风险，建议您开通账号登录二次认证。如下图所示，在输入账号密码后，需要额外再输入授权码后才可成功登录账号。

![](fortitokenlogin.png)

开通登录保护的前提条件如下：

- 移动设备上安装有 FortiToken身份认证工具或其他基于 TOTP 技术的令牌工具；
- 推荐使用FortiToken ；

### 2.4.2 关闭登录保护

已开启登录保护的admin支持关闭登录账户。点击admin账号头像，选择“关闭登录保护”操作，输入在FortiToken中获取到的授权码，点击确认即可关闭登录保护功能。

### 2.4.3 登录保护FAQ

Q1: FortiToken怎么下载？

A1：账号绑定页面提供 ISO 和 Android 工具下载链接，可选择通过移动设备扫码下载。

------

Q2: FortiToken 无法扫描获取授权码怎么办？

可切换至手动获取，在FortiToken的二维码扫码框下方点击手动输入，输入账号密钥进行绑定，即可获取授权码。

-------

Q3: 是否可以用其他工具绑定账号？

A3：可以用基于 TOTP 算法的其他动态令牌工具绑定账号，如Google Authoriticator、FortiToken 、微信小程序“二次验证码”等。为安全起见，推荐使用FortiToken 。

------

Q4：同一个账号是否支持绑定多个终端工具？

A4：支持。您只需要使用多个终端绑定同一账号（扫码或输入密钥）即可。建议您在绑定工具时妥善保存系统提供的密钥，方便后续添加绑定新的终端

## 2.5 登录访问限制

### 2.5.1 开启登录访问限制

平台支持为admin账号设置登录访问限制，设置登录限制策略后，admin账号只能从指定IP登录控制台或发起API访问。点击admin账号头像，选择“登录访问控制”操作，在登录访问范围输入框中输入IP地址或者IP地址段，点击确认即可。

### 2.5.2 取消登录访问限制

支持为admin账号取消登录访问限制，点击admin账号头像，选择“登录访问控制”操作，删除登录访问范围输入框中的IP地址或者IP地址段，点击确认即可。

## 2.6 获取API密钥

支持获取admin账号的 API 密钥 ，用于管理并使用 API 接口，点击admin账号头像，选择“查看API密钥”，即可获取admin账号的公钥和私钥信息。

# 3 地域管理

地域（Region)是UcloudStack云平台中一个逻辑概念，也是最大的资源定义，包括计算集群、二层网路、存储集群等资源。一个地域一般对应数据中心中的一个机房。
通常情况下，不同地域之间完全隔离以保证不同地域间最大程度的稳定性和容错性。地域概念的引入，使得云平台具备了跨数据中心的高可用能力。UcloudSatck支持多地域部署，可以使用同一portal管理不同地域的云数据中心。

## 3.1 编辑地域信息

在管理平台地域管理列表，点击对应地域右侧的操作按钮，选择修改按钮，可修改地域名称。

![](editregion.png)

## 3.2 查看地域

### 3.2.1 地域列表

地域列表页可查看当前下已有的地域列表，包括地域ID、地域名称、Endpoint、总核数、已分配核数、总内存、已分配内存、创建时间，同时也可通过“自定义列表”按钮，自定义列表所需信息。

![](regionmanage.png)

地域ID：地域在平台的唯一ID标识。

地域名称：地域的名称，可通过独立的命名区分不同地域，比如北京数据中心一号机房。

Endpoint：每个地域的API服务端点。

总核数：地域下总的vCPU核数。

已分配核数：地域下已分配vCPU核数，如果一个地域下已经分配的CPU核数占总核数比例超过80%以上，代表地域下可用vCPU资源已较少，建议平台管理员联系企业云资源使用者及时释放不再使用的云资源，确保真正需要使用资源的用户可及时分配到云资源。

总内存：地域下总内存容量。

已分配内存：地域下已分配到总内存容量。如果一个地域下已经分配的内存容量占总核数比例超过80%以上，代表地域下可用内存资源已较少，建议平台管理员联系企业云资源使用者及时释放不再使用的云资源，确保真正需要使用资源的用户可及时分配到云资源。

创建时间：地域的创建时间。

###3.2.2 地域详细信息

在地域列表中点击地域名称，或者点击目标地域列表右侧的“详情”按钮，可进入当前低于的概览页面，查看地域的基本信息及监控信息。同时可以切换标签，查看和管理地域下的基础镜像、计算集群和存储集群。

###3.2.2.1 地域概览

概览页面展示基本信息和地域核心资源使用趋势的监控图表。

* 基本信息主要展示基本信息包括地域ID、地域名称、创建时间、EndPoint、总核数、已分配核数、总内存、已分配内存。
* 监控图表：计算实例数量趋势（包括总量、运行状态和关机状态下的虚拟机）、CPU核数的使用趋势（包括总量、已分配、未分配）、EIP个数的使用趋势（包括总量、已分配、未分配）、内存容量使用趋势(包括总量、已分配、未分配)。可通过筛选按钮，调节图表的显示时间周期，满足根据不同时间颗粒度的查看地域核心资源使用趋势的需求。

![](regionoverview.png)

#### 3.2.2.2 基础镜像管理

点击“基础镜像管理”标签，查看和管理平台基础镜像，基础镜像是平台初始化是提供给用户创建虚拟机使用的镜像文件。UcloudStack云平台支持Centos、Windows、Ubuntu系统类型的虚拟机操作系统镜像，并提供的初始镜像包括 Centos 6.5 64 、Centos 7.4 64 、Windows 2008r2 64 、Windows 2012r2 64 、Ubuntu 14.04 64 、Ubuntu 16.04 64。

如果平台需要其他基础镜像系统，可参考自制镜像管理页面中的参考文档，制作镜像导入为自制镜像中，再复制为基础镜像。

#### 3.2.2.3 计算集群

点击“计算集群”标签，可查看地域下的计算集群列表以及集群的资源总量和分配情况。计算集群是一组作为计算节点使用的物理机的逻辑集合。有关计算集群的管理操作参见章节4中集群管理部分的描述。。

#### 3.2.2.4 存储集群

点击“存储集群“，可查看地域下的存储计算列表以及集群的资源总量和分配情况。有关存储集群的管理操作参见章节4中集群管理部分的描述。

# 4 集群管理

## 4.1 计算集群

一个地域下可部署不同类型的计算集群，如普通 x86、GPU、ARM 等，默认情况下，根据CPU 平台架构设定集群名称，管理员也可根据平台自身使用情况修改集群名称。

### 4.1.1 查看计算集群

#### 4.1.1.1 计算集群列表

计算集群包括以下信息：

- 集群 ID ：集群在平台唯一的ID
- 集群类型：集群的类型
- 集群类型名称：标志集群类型的名称，租户在创建虚拟机可以根据集群类型名称
- GPU 总颗数：集群中所有物理节点上的所有GPU设备的总颗数。
- 已分配总颗数:集群中已分配的GPU颗数。
- CPU 总核数 ：集群中总的vCPU核数。
- 已分配核数 ：集群下已分配vCPU核数，如果一个集群下已经分配的CPU核数占总核数比例超过80%以上，代表地域下可用vCPU资源已较少，建议平台管理员联系企业云资源使用者及时释放不再使用的云资源，确保真正需要使用资源的用户可及时分配到云资源。
- 总内存(GB)：集群中总的内存容量。
- 已分配内存(GB) ：地域下已分配到总内存容量。如果一个地域下已经分配的内存容量占总核数比例超过80%以上，代表地域下可用内存资源已较少，建议平台管理员联系企业云资源使用者及时释放不再使用的云资源，确保真正需要使用资源的用户可及时分配到云资源。
- 创建时间 ：计算集群的创建时间。

#### 4.1.1.2 计算集群概览

点击目标计算集群名称或者列表后的详情按钮，可查看计算集群概览页面展示基本信息和监控信息。

- 基本信息主要展示集群ID、集群类型、分配权重、总核数、已分配核数、总内存、已分配内存。
- 监控信息主要展示集群下CPU核数的使用趋势（包括总量、已分配、未分配）、内存容量使用趋势(包括总量、已分配、未分配)。

### 4.1.2 集群的计算实例管理

在概览页面切换“计算实例”标签，可查看和管理计算集群下的计算实例。

####4.1.2.1 查看集群下的计算实例

实例包含以下信息：

名称：虚拟机的名称

计算实例ID：虚拟机所对应底层计算实例的ID

资源ID：计算实例所对应资源ID

所属租户：计算实例所属的租户

物理机IP：计算实例宿主机的IP

镜像IP：计算实例所使用镜像的ID

GPU：计算实例的GPU颗数

CPU：计算实例的CPU核数

内存：计算实例的内存大小

状态：计算实例的状态

创建时间：计算实例的创建时间

更新时间：计算实例的更新时间

#### 4.1.2.2 迁移计算集群下的实例

可以使用热迁移功能虚拟机从一个计算节点或移至另一计算节点。以便执行维护、平衡计算节点负载、将相互通信的虚拟机迁移至一个计算节点、将多个虚拟机分散到不同的计算节点以提高高可用。

前提条件

- 虚拟机为正常运行状态
- 当前集群中有足够的资源能够满足迁移需求
- 虚拟机上面未挂载GPU设备
- 虚拟机所部署的业务不存在频繁读写操作，否则有可能会造成网络传输的短暂中断

操作流程：

点击目标计算实例右侧的迁移按钮，选定迁移模式。迁移模式分为指定物理节点和随机分配两种。如果迁移有明确的目标节点，比如虚拟机当前所在物理机器负载过高，迁移到已知的负载较低的物理节点上，可选择指定物理节点迁移模式，并根据IP挑选出目标物理节点，点击确认即可迁移。如果无明确目标计算节点，可选择随机分配迁移模式，系统将自动选定合适的物理节点。

![](instancemigrate.png)

#### 4.1.2.3 宕机自动迁移

UcloudStack平台提供虚拟机高可用保障服务。当物理机器宕机或者网络连接出现问题时，UcloudStack平台将启动自动迁移服务，对故障物理机器上虚拟机进行自动迁移，迁移后的虚拟机将继续正常运行。

宕机自动迁移的的使用注意事项和功能限制？

### 4.1.3 管理集群下的物理机

在概览页面切换“物理机”标签，可查看和管理计算集群下的物理机。

#### 4.1.3.1 查看集群下物理机

物理机页面列出了该计算集群下所有的物理机，可快速了解集群下所有物理机的基本信息以及各个物理机的总容量和已使用容量。

#### 4.1.3.2 锁定物理机

物理机被锁定后，新创建的虚拟机将不再往此物理机上调度。一般在需要对物理机维护和升级时，需要先锁定物理机，再进行操作。再配合UcloudStack物理机进入维护模式功能，可以平滑实现计算集群的维护、升级等操作。

#### 4.1.3.3 进入物理机维护模式

#### 4.1.3.4 解锁物理机

#### 





### 4.1.4 修改集群类型名称

支持修改集群类型名称，可根据平台使用需求，为计算集群命名更有标志性的名称。在计算集群列表点击“修改集群类型名称”，输入新名称即可更改集群类型名称。

> 修改集群类型名称，对所有集群类型为此类型的集群均生效。

### 4.1.5修改集群类型权限

平台的计算集群默认对所有租户开放权限。在某些特殊场景下，比如特殊机型的物理服务器集群、GPU物理服务器集群只希望对少部分租户开放权限，可通过修改集群权限类型对集群的权限进行修改。

在计算集群列表点击“修改”集群类型权限，选择集群类型，指定租户权限为“所有租户”或“指定租户”，点击确认即可生效。如果租户未被开放某个计算集群类型的授权，在创建虚拟机时将无法选定和此计算集群类型对应的机型。

## 4.2 存储集群

地域可部署不同类型的存储集群，如 SSD、SATA、SAS 等。一般根据存储介质或存储用途设定集群名称，管理员也可根据自身情况修改集群名称。存储集群列表包括以下信息：

集群ID：存储集群平台上域中唯一的ID

集群类型：存储集群的类型

集群类型名称：存储集群类型的名称，作为在平台的标识

总存储：存储集群的总容量，单位为GB

已使用存储：存储集群的已使用容量，单位为GB

更新时间：存储集群的更新时间

##  4.3 外置存储

# 5 物理资源管理

### 5.1.1 物理机管理



### 5.1.2 外网网段管理

### 5.1.3 物理机纳管



## 5.2 虚拟资源管理

# 6 租户管理

# 7 审批管理

为了帮助企业优化云资源的管理流程，UcloudStack提供审批流程管理功能。当租户下设置了审批流程后，租户下的用户申请资源需要提出申请工单，只有当admin审批通过后，资源才会下发到租户。针对云资源使用需要走审批流程，但不需要人工介入审批的企业，也可以在为租户开启审批流程的同时，开启自动审批过程，此时租户下的资源申请依然会生成相应的审批流程。
目前支持审批流程的云资源操作包括：
创建云主机、创建云盘、创建私有网络、创建外网IP、创建负载均衡、虚拟机修改配置、虚拟机热升级、扩容根磁盘、扩容数据盘、调整带宽。

## 7.1租户审批流程管理

### 7.1.1 为租户开启审批流程

####7.1.1新创建的租户

在新建租户时，可以直接为租户开启审批流程，并设置开启自动审批。

####7.1.2 已创建的租户

已创建的租户如果需要设置审批流程，可在租户管理页面通过编辑审批流程操作设置审批流程。

###7.1.2查看租户审批流程

admin可在租户管理页面查看账户是否已设置审批流程，是否已开启自动审批。

###7.1.3 编辑租户审批流程

admin可在租户管理页面为租户编辑审批流程，包括为租户开启/关闭审批流程以及开启/关闭自动审批。

## 7.2 审批管理

# 8 账务管理

UcloudSatck为用户提供完整的平台财务管理能力，包括订单管理、交易管理、充值管理、价格配置四大模块。

订单管理：查看平台发生的所有订单记录，或者或者自定义查询时间段对订单记录进行查询。

交易管理：查看平台所有交易的扣费记录，或者自定义查询时间段对交易的扣费记录进行查询。

充值管理：查看平台所有的充值记录，或者自定义查询时间段对充值记录进行搜索。

价格配置：对平台售卖的云服务按照预定义的维度进行定价和定价修改。

## 8.1 订单管理

## 8.2 交易管理

## 8.3 充值管理

## 8.4 价格配置



# 9 平台管理

# 10 监控大屏





