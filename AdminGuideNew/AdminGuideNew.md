# 管理员指南

#### 版权声明

版权所有 ©  优刻得科技股份有限公司 2020 保留一切权利。

非经本公司书面许可，任何单位和个人不得擅自摘抄、复制本文档内容的部分或全部，并不得以任何形式传播。

UCloudStack 商标和 UCloud 商标为优刻得科技股份有限公司所有。对于本手册中可能出现的其它公司的商标及产品标识，由各自权利人拥有。

注意您购买的产品、服务或特性等应受优刻得科技股份有限公司商业合同和条款约束，本文档中描述的全部或部分产品、服务或特性可能不在您的购买或使用权利范围之内。除非合同另有约定，优刻得科技股份有限公司对本文档内容不做任何明示或暗示的声明或保证。

由于产品版本升级或其它原因，本文档内容会不定期更新，除非另有约定，本文档仅作为使用指导，本文档中的所有陈述、信息和建议不构成任何明示或暗示的担保。

本文档描述 UCloudStack （v1.20.0）云平台的管理员功能说明和操作指南，适用于需要通过管理控制台管理并运营整个平台的资源、账户及相关配置的平台管理者和运营者，开发者可参考 API 开发者文档。

# 1 概述

UcloudStack管理后台是开放给企业云管理员、运维人员使用的管理后台，主要提供物理资源、虚拟资源管理、账户管理、流程审批、运维迁移等平台管理功能。

# 2 管理员账号

admin账号是UcloudStack云平台提供的默认管理账号，具有平台最高权限，可以对云平台所有区域的云数据中心进行物理资源管理、虚拟资源管理、平台运维及运营管理等相关操作。针对admin账号平台提供通用的账号管理和安全防护功能，包括修改登录密码、修改账号邮箱、找回密码、开启登录保护、登录访问限制，同时可以获取Admin账号的API 公钥和私钥信息。

## 2.1 修改登录密码

点击admin账号头像，选择“修改登录密码”操作，确认当前登录密码，输入和确认新密码后，可完成admin账号的修改。

##2.2 修改账号邮箱

点击admin账号头像，选择“修改登录邮箱”操作，输入新邮箱后，可完成admin账号邮箱的修改。

## 2.3 找回密码

平台支持admin账号在忘记密码时通过控制台自主找回密码，找回密码时需通过邮箱进行验证，请确保admin账号添加的账号为真实可用的邮箱。如果admin账号已设置的邮箱未无效邮箱，可通过2.2中修改账号邮箱操作更新。通过登录页面的【找回密码】功能，即可使用邮箱地址验证重新为admin账号设置新密码。

## 2.4 登陆保护

### 2.4.1开启登录保护

admin账号可使用平台提供免费的基于 TOTP（Time-Based One-Time Password Algorithm）登录二次认证服务。点击admin头像，选择“开启登录保护”操作。使用设备中事先下载好的的FortiToken应用，扫描获取授权码处的二维码，再输入FortiToken中展示的授权码后，点击确认，即可为admin账号开启账号登录保护功能。
![](loginprotect.png)

开通本服务后，admin账号每次登录控制台均需通过授权认证。 为了降低admin账号密码泄漏造成的风险，建议您开通账号登录二次认证。如下图所示，在输入账号密码后，需要额外再输入授权码后才可成功登录账号。

![](fortitokenlogin.png)

开通登录保护的前提条件如下：

- 移动设备上安装有 FortiToken身份认证工具或其他基于 TOTP 技术的令牌工具；
- 推荐使用FortiToken ；

### 2.4.2 关闭登录保护

已开启登录保护的admin支持关闭登录账户。点击admin账号头像，选择“关闭登录保护”操作，输入在FortiToken中获取到的授权码，点击确认即可关闭登录保护功能。

### 2.4.3 登录保护FAQ

Q1: FortiToken怎么下载？

A1：账号绑定页面提供 ISO 和 Android 工具下载链接，可选择通过移动设备扫码下载。

------

Q2: FortiToken 无法扫描获取授权码怎么办？

可切换至手动获取，在FortiToken的二维码扫码框下方点击手动输入，输入账号密钥进行绑定，即可获取授权码。

-------

Q3: 是否可以用其他工具绑定账号？

A3：可以用基于 TOTP 算法的其他动态令牌工具绑定账号，如Google Authoriticator、FortiToken 、微信小程序“二次验证码”等。为安全起见，推荐使用FortiToken 。

------

Q4：同一个账号是否支持绑定多个终端工具？

A4：支持。您只需要使用多个终端绑定同一账号（扫码或输入密钥）即可。建议您在绑定工具时妥善保存系统提供的密钥，方便后续添加绑定新的终端

## 2.5 登录访问限制

### 2.5.1 开启登录访问限制

平台支持为admin账号设置登录访问限制，设置登录限制策略后，admin账号只能从指定IP登录控制台或发起API访问。点击admin账号头像，选择“登录访问控制”操作，在登录访问范围输入框中输入IP地址或者IP地址段，点击确认即可。

### 2.5.2 取消登录访问限制

支持为admin账号取消登录访问限制，点击admin账号头像，选择“登录访问控制”操作，删除登录访问范围输入框中的IP地址或者IP地址段，点击确认即可。

## 2.6 获取API密钥

支持获取admin账号的 API 密钥 ，用于管理并使用 API 接口，点击admin账号头像，选择“查看API密钥”，即可获取admin账号的公钥和私钥信息。

# 3 地域管理

地域（Region)是UcloudStack云平台中一个逻辑概念，也是最大的资源定义，包括计算集群、二层网路、存储集群等资源。一个地域一般对应数据中心中的一个机房。
通常情况下，不同地域之间完全隔离以保证不同地域间最大程度的稳定性和容错性。地域概念的引入，使得云平台具备了跨数据中心的高可用能力。UcloudSatck支持多地域部署，可以使用同一portal管理不同地域的云数据中心。

## 3.1 编辑地域信息

在管理平台地域管理列表，点击对应地域右侧的操作按钮，选择修改按钮，可修改地域名称。

![](editregion.png)

## 3.2 查看地域

### 3.2.1 地域列表

地域列表页可查看当前下已有的地域列表，包括地域ID、地域名称、Endpoint、总核数、已分配核数、总内存、已分配内存、创建时间，同时也可通过“自定义列表”按钮，自定义列表所需信息。

![](regionmanage.png)

- 地域ID：地域在平台的唯一ID标识

- 地域名称：地域的名称，可通过独立的命名区分不同地域，比如北京数据中心一号机房

- Endpoint：每个地域的API服务端点

- 总核数：地域下总的vCPU核数

- 已分配核数：地域下已分配vCPU核数，如果一个地域下已经分配的CPU核数占总核数比例超过80%以上，代表地域下可用vCPU资源已较少，建议平台管理员联系企业云资源使用者及时释放不再使用的云资源，确保真正需要使用资源的用户可及时分配到云资源

- 总内存：地域下总内存容量

- 已分配内存：地域下已分配到总内存容量。如果一个地域下已经分配的内存容量占总核数比例超过80%以上，代表地域下可用内存资源已较少，建议平台管理员联系企业云资源使用者及时释放不再使用的云资源，确保真正需要使用资源的用户可及时分配到云资源

- 创建时间：地域的创建时间

###3.2.2 地域详细信息

在地域列表中点击地域名称，或者点击目标地域列表右侧的“详情”按钮，可进入当前低于的概览页面，查看地域的基本信息及监控信息。同时可以切换标签，查看和管理地域下的基础镜像、计算集群和存储集群。

###3.2.2.1 地域概览

概览页面展示基本信息和地域核心资源使用趋势的监控图表。

* 基本信息主要展示基本信息包括地域ID、地域名称、创建时间、EndPoint、总核数、已分配核数、总内存、已分配内存。
* 监控图表：计算实例数量趋势（包括总量、运行状态和关机状态下的虚拟机）、CPU核数的使用趋势（包括总量、已分配、未分配）、EIP个数的使用趋势（包括总量、已分配、未分配）、内存容量使用趋势(包括总量、已分配、未分配)。可通过筛选按钮，调节图表的显示时间周期，满足根据不同时间颗粒度的查看地域核心资源使用趋势的需求。

![](regionoverview.png)

#### 3.2.2.2 基础镜像管理

点击“基础镜像管理”标签，查看和管理地域下所有的基础镜像，基础镜像是平台初始化是提供给用户创建虚拟机使用的镜像文件。有关基础镜像的管理操作参见章节5中镜像管理部分的描述。

#### 3.2.2.3 自制镜像管理

点击“自制镜像”标签，可查看和管理地域下所有的自制镜像。有关自制镜像的管理操作参见章节5中镜像管理部分的描述。

#### 3.2.2.4 计算集群

点击“计算集群”标签，可查看地域下的计算集群列表以及集群的资源总量和分配情况。计算集群是一组作为计算节点使用的物理机的逻辑集合。有关计算集群的管理操作参见章节4中集群管理部分的描述。

#### 3.2.2.5 存储集群

点击“存储集群“，可查看地域下的存储计算列表以及集群的资源总量和分配情况。有关存储集群的管理操作参见章节4中集群管理部分的描述。

#### 3.2.2.6 外置存储

通过 ISCSI 协议对接商业存储，将商业存储作为虚拟化后端存储池。点击“外置存储”，可查看地域下的外置存储池，即商业存储集群池。有关外置存储的管理操作参见章节4中集群管理部分的描述。

# 4 集群管理

## 4.1 计算集群

一个地域下可部署不同类型的计算集群，如普通 x86、GPU、ARM 等，默认情况下，根据CPU 平台架构设定集群名称，管理员也可根据平台自身使用情况修改集群名称。

### 4.1.1 查看计算集群

#### 4.1.1.1 计算集群列表

计算集群包括以下信息：

- 集群 ID ：集群在平台唯一的ID
- 集群类型：集群的类型
- 集群类型名称：标志集群类型的名称，租户在创建虚拟机可以根据集群类型名称
- GPU 总颗数：集群中所有物理节点上的所有GPU设备的总颗数
- 已分配总颗数:集群中已分配的GPU颗数
- CPU 总核数 ：集群中总的vCPU核数
- 已分配核数 ：集群下已分配vCPU核数，如果一个集群下已经分配的CPU核数占总核数比例超过80%以上，代表地域下可用vCPU资源已较少，建议平台管理员联系企业云资源使用者及时释放不再使用的云资源，确保真正需要使用资源的用户可及时分配到云资源
- 总内存(GB)：集群中总的内存容量
- 已分配内存(GB) ：地域下已分配到总内存容量。如果一个地域下已经分配的内存容量占总核数比例超过80%以上，代表地域下可用内存资源已较少，建议平台管理员联系企业云资源使用者及时释放不再使用的云资源，确保真正需要使用资源的用户可及时分配到云资源
- 创建时间 ：计算集群的创建时间

#### 4.1.1.2 计算集群概览

点击目标计算集群名称或者列表后的详情按钮，可查看计算集群概览页面展示基本信息和监控信息。

- 基本信息主要展示集群ID、集群类型、分配权重、总核数、已分配核数、总内存、已分配内存。
- 监控信息主要展示集群下CPU核数的使用趋势（包括总量、已分配、未分配）、内存容量使用趋势(包括总量、已分配、未分配)。

### 4.1.2 集群的计算实例管理

在概览页面切换“计算实例”标签，可查看和管理计算集群下的计算实例。

####4.1.2.1 查看集群下的计算实例

实例包含以下信息：

- 名称：虚拟机的名称

- 计算实例ID：虚拟机所对应底层计算实例的ID

- 资源ID：计算实例所对应资源ID

- 所属租户：计算实例所属的租户

- 物理机IP：计算实例宿主机的IP

- 镜像IP：计算实例所使用镜像的ID

- GPU：计算实例的GPU颗数

- CPU：计算实例的vCPU核数

- 内存：计算实例的内存大小

- 状态：计算实例的状态

- 创建时间：计算实例的创建时间

- 更新时间：计算实例的更新时间

#### 4.1.2.2 迁移计算集群下的实例

可以使用热迁移功能虚拟机从一个计算节点或移至另一计算节点。以便执行维护、平衡计算节点负载、将相互通信的虚拟机迁移至一个计算节点、将多个虚拟机分散到不同的计算节点以提高高可用。

前提条件

- 虚拟机为正常运行状态
- 当前集群中有足够的资源能够满足迁移需求
- 虚拟机上面未挂载GPU设备
- 虚拟机所部署的业务不存在频繁读写操作，否则有可能会造成网络传输的短暂中断

操作流程：

点击目标计算实例右侧的迁移按钮，选定迁移模式。迁移模式分为指定物理节点和随机分配两种。如果迁移有明确的目标节点，比如虚拟机当前所在物理机器负载过高，迁移到已知的负载较低的物理节点上，可选择指定物理节点迁移模式，并根据IP挑选出目标物理节点，点击确认即可迁移。如果无明确目标计算节点，可选择随机分配迁移模式，系统将自动选定合适的物理节点。

![](instancemigrate.png)

#### 4.1.2.3 宕机自动迁移

UcloudStack平台提供虚拟机高可用保障服务。当物理机器宕机或者网络连接出现问题时，UcloudStack平台将启动自动迁移服务，对故障物理机器上虚拟机进行自动迁移，迁移后的虚拟机将继续正常运行。

宕机自动迁移的的使用注意事项和功能限制？

### 4.1.3 管理集群下的物理机

在概览页面切换“物理机”标签，可查看和管理计算集群下的物理机。

#### 4.1.3.1 查看集群下物理机

物理机页面列出了该计算集群下所有的物理机，可快速了解集群下所有物理机的基本信息以及各个物理机的总容量和已使用容量。

#### 4.1.3.2 锁定物理机

物理机被锁定后，新创建的虚拟机将不再往此物理机上调度，配合物理机进入维护模式功能，可以平滑实现物理机的维护、升级等操作。

#### 4.1.3.3 进入物理机维护模式

当需要维护物理机时，比如扩展内存、升级、修复硬件等维护场景下，需要将物理机置于维护模式，此时，物理机上的虚拟资源将被自动迁移到同计算集群中其他物理节点上，保持业务的正常运行。
![](maintenance.png)
在将物理机进入维护模式，请执行以下检查：

* 物理机上是否有不可迁移的资源，如 GPU 虚拟机或处于中间状态的虚拟机；如果存在此类资源，物理机器可以进入锁定模式，并进入维护模式，但中间状态的虚拟机和GPU虚拟机无法被迁移成功。
* 集群内空闲资源是否足够迁移当前物理机的所有计算实例；

操作流程：选择目标物理机器，点击右侧“锁定”按钮，继续点击“进入维护模式”按钮，将物理机器进入到维护模式。此时，系统会自动执行在线迁移功能，将此物理机器上的资源随机迁移至本计算集群中其他合适的物理机器上。

> 如果物理机器上有无法被成功迁移的资源，进入维护模式将被中断，物理机器将停留在锁定状态。您可以继续执行物理机进入维护模式操作，再次尝试迁移未被成功迁移的资源。

#### 4.1.3.4 解锁物理机

将锁定的物理机解锁，重新投入生产。请在解锁前确保此物理机问题已经被修复，可正常投入生产。

### 4.1.4 修改集群类型名称

支持修改集群类型名称，可根据平台使用需求，为计算集群命名更有标志性的名称。在计算集群列表点击“修改集群类型名称”，输入新名称即可更改集群类型名称。

> 修改集群类型名称，对所有集群类型为此类型的集群均生效。

### 4.1.5修改集群类型权限

平台的计算集群默认对所有租户开放权限。在某些特殊场景下，比如特殊机型的物理服务器集群、GPU物理服务器集群只希望对少部分租户开放权限，可通过修改集群权限类型对集群的权限进行修改。

在计算集群列表点击“修改”集群类型权限，选择集群类型，指定租户权限为“所有租户”或“指定租户”，点击确认即可生效。如果租户未被开放某个计算集群类型的授权，在创建虚拟机时将无法选定和此计算集群类型对应的机型。

## 4.2 存储集群

地域可部署不同类型的存储集群，如 SSD、SATA、SAS 等。一般根据存储介质或存储用途设定集群名称，管理员也可根据自身情况修改集群名称。存储集群列表包括以下信息：

- 集群ID：存储集群平台上域中唯一的ID

- 集群类型：存储集群的类型

- 集群类型名称：存储集群类型的名称，作为在平台的标识

- 总存储：存储集群的总容量，单位为GB

- 已使用存储：存储集群的已使用容量，单位为GB

- 更新时间：存储集群的更新时间

##  4.3 外置存储

### 4.3.1 查看外置存储集群

支持查看外置存储集群列表以及集群下已扫描出的 LUN 信息列表。

###4.3.2 新建外置存储集群

支持管理员录入 ISCSI 设备信息，创建外置存储集群。点击“新建按钮”，输入外置存储集群的名称和ISCSI地址。

###4.3.3 扫描外置存储池

扫描存储池，获取存储池中的存储卷 LUN 信息列表。

### 4.3.4 分配LUN给租户

将存储池中处于非挂载状态的 LUN 分配给某个租户或更换租户

### 4.3.5 删除外置存储池

除外置存储池，存储池中所有 LUN 未被使用才能被删除

#5 镜像管理

镜像是云主机所使用的镜像模板文件，UcloudStack云平台支持Centos、Windows、Ubuntu系统类型的虚拟机操作系统镜像，并提供初始基础镜像，包括Centos 6.5 64 、Centos 7.4 64 、Windows 2008r2 64 、Windows 2012r2 64 、Ubuntu 14.04 64 、Ubuntu 16.04 64。

平台镜像分为基础镜像和自制镜像：

- 基础镜像是由平台官方默认提供，包括多发行版 Centos 、Ubuntu 及 Windows 等原生操作系统；
- 自制镜像由用户通过虚拟机自行导出或自定义导入的自有镜像，可用于创建虚拟机，仅账号自身有权限查看和管理。

## 5.1 基础镜像管理

### 5.1.1 查看基础镜像

在基础镜像列表可查看平台所有基础镜像。基础镜像的列表信息包括：

- 镜像名称：镜像的标识名称

- 资源ID：镜像文件在平台的唯一标识

- 系统类型：镜像文件的操作系统类型

- 操作系统：镜像文件的操作系统版本

- 状态：镜像文件可用状态标注

### 5.1.2 删除基础镜像

可以通过删除基础镜像下线平台不需要使用的基础镜像。

> 如果平台存在通过此基础镜像创建的虚拟机，则基础镜像无法被删除。

### 5.1.3 修改基础镜像名称和备注

修改基础镜像的名称和备注，在任何状态下均可进行操作。可通过点击基础镜像列表页面每个镜像名称右侧的“编辑”按钮进行修改。

## 5.2 自制镜像管理

###5.2.1 查看自制镜像

在自制镜像列表可查看平台所有的自制镜像。自制镜像的列表信息包括：

- 镜像名称：镜像的标识名称

- 资源ID：镜像文件在平台的唯一标识

- 所属租户：自制镜像所归属的租户的主账号的邮箱和ID

- 系统类型：镜像文件的操作系统类型

- 操作系统：镜像文件的操作系统版本

- 状态：镜像文件的状态标注
  - 创建中：镜像文件正在创建中
  - 销毁中：镜像文件正在销毁中
  - 可用：镜像文件可用
  - 删除中：镜像文件删除中
  - 已删除：镜像文件已删除进入回收站
  - 导入中：镜像文件正在导入中
  - 导入失败：镜像文件导入失败

###5.2.2导入自制镜像

导入镜像是指将第三方业务虚拟机以镜像的方式迁移到平台镜像仓库，以便通过导入的镜像创建并部署业务虚拟机，是用户将业务迁移至 UCloudStack 平台的重要通道。

支持导入 Linux 和 Windows 发行版及自定义镜像，并支持 X86 架构和 aarch64 两种系统架构镜像的导入；云平台的镜像格式默认为 QCOW2，用户上传 VHD、VMDK、QCOW2、OVA、ISO 等格式的镜像时，需先将镜像转换为QCOW2格式的镜像才可导入。有关转换镜像及自定义镜像的具体操作可参考[自定义镜像指南]() 。

![](upimage.png)

管理员制作好自定义镜像后，可通过镜像管理控制台资源列表上方的【导入镜像】功能，进入导入镜像向导页面：

- 租户邮箱：通过租户主账号邮箱选定自制镜像归属的租户

- 镜像名称/描述：镜像的名称及相关描述信息；
- 镜像地址：平台导入镜像时读取并下载镜像的 URL 地址，导入镜像时必须提供；
  - 支持 HTTP、HTTPS、FTP 等协议的 URL 地址，格式包括 `https://path/file` 或`ftp://hostname[:port]/path/file` 或 `ftp://user:password@hostname[:port]/path/file` ；
  - 镜像的地址必须从云平台可达，即云平台组件可访问的 URL 地址，建议使用云平台相同外网的 IP 地址；
- 操作系统：导入镜像的操作系统类型，包括 Linux 和 Windows ，需根据导入镜像 OS 类型进行选择；
- 系统架构：导入镜像的系统架构，包括 `x86_64` 和 `aarch64` ，需根据导入镜像进行选择；
- 系统平台：指导入镜像的操作系统平台；
  - Linux 操作系统的系统平台包括 Centos 和 Ubuntu ；
  - Windows 操作系统的系统平台仅支持 Windows ；
- 系统版本：当前需导入镜像的操作系统版本；
  - CentOS 支持 CentOS 6  和 CentOS 7 版本；
  - Ubuntu 支持 Ubuntu 14 和 Ubuntu 16 版本；
  - Windows  支持 WIN2008 和 WIN2012  版本；
- 镜像格式：当前平台仅支持导入 RAW 格式的镜像；
- 镜像大小：当前导入镜像的大小，最大不能超过 500GB ；
- SHA256 ：用于校验文件完整性的值，默认无需指定。

镜像导入后，自制镜像列表生成一条状态为 “导入中” 的镜像，由于平台需要先下载镜像至镜像仓库且镜像通常较大，导入镜像的时间通常比较长。

镜像状态转换为可用时，即代表镜像导入成功，可进行虚拟机创建或进行镜像下载操作；若镜像导入过程中出现意外导致失败，则镜像的状态会转换为“导入失败” ，可对失败的镜像进行删除并重新导入镜像。

> 导入镜像前需确保镜像地址可被访问且可读取并下载到镜像。

### 5.2.3 创建虚拟机

管理员可从自制镜像为租户启动一台虚拟机。创建的虚拟机将归属于自制镜像所归属的租户，虚拟机中的程序及数据保持自制镜像的创建时的状态。创建时镜像文件自动选定为自制镜像，其他流程和普通虚拟机的创建流程相同。

### 5.2.4复制为基础镜像

如果平台需要其他基础镜像系统，可先上传为自制镜像，再通过“复制为基础镜像”的功能转化为平台基础镜像。

操作流程：点击目标自制镜像右侧“复制为自制镜像”操作，输入基础镜像名称，点击确认。此时，基础镜像列表中会出现一条最新的基础镜像记录，状态为“制作中”。当状态转换为“可用”时，代表基础镜像转换成功。可使用此镜像创建一台虚拟机来验证镜像文件是否转换成功。

### 5.2.5下载自制镜像

下载镜像指将平台自制的镜像下载至本地，用于备份或迁移。虚拟机镜像通常为 GB 级别文件，为保证下载镜像的断点续传等功能，平台以提供下载地址的方式支持镜像下载；可通过 FTP、 SFTP 及相关工具进行镜像下载，以保证断点续传功能，提升镜像下载的成功率。

操作流程：点击自制镜像列表操作项中的【下载】进入镜像下载向导页面。点击生成下载地址后，平台会跳转至下载地址展示向导页面。复制页面中的地址链接，通过 HTTP、FTP 及相关下载工具下载镜像。

> 镜像下载地址有效期为 24 小时，需在 24 小时内进行镜像下载。若镜像下载地址过期，则无法进行下载，需到平台重新生成镜像下载地址。

### 5.2.6 删除自制镜像

管理员可对自制镜像进行删除操作，被删除的自制镜像会自动进入“**回收站**”，可进行还原和销毁操作。用户可通过自制镜像管理控制台的“删除”功能进行自制镜像的删除，删除后可到回收站中查看已删除的自制镜像。

> 仅支持删除状态为可用或导入失败的的自制镜像；若已通过自制镜像创建虚拟机，则不可删除自制镜像，需要将虚拟机删除，才可进行自制镜像的删除。

### 5.2.7 修改自制镜像名称和备注

修改自制镜像的名称和备注，在任何状态下均可进行操作。可通过点击自制镜像列表页面每个镜像名称右侧的“编辑”按钮进行修改。

# 6 物理资源管理

### 6.1 物理机管理

有关物理机器锁定、解锁、进入维护模式等运维场景下的操作，请参考4.1.3章节描述

###6.1.1 查看物理机列表

在计算资源/物理机页面可查看平台下所有物理机器信息，物理机器的列表信息包括：

- 物理机ID：物理机器的平台唯一ID标识

- 物理机IP：物理机器的IP地址

- 计算集群ID：物理机器所属计算集群的ID

- CPU类型：物理CPU类型，如intel

- 总核数：物理机的vCPU核数

- 已分配核数：物理机

- 总内存：

- 已分配内存：

- 状态：物理机器的状态
  - 创建中：物理机器正在创建中
  - 无效：物理机器无效代表节点服务异常
  - 有效：物理机器有效代表节点服务正常
  - 更新中：物理节点信息正在更新中
  - 删除中：物理节点正在被删除
  - 已删除：物理节点已被删除


- 更新时间：物理节点的更新时间

### 6.1.2 查看物理机详情

点击目标物理机器名称或者右侧的“详情”按钮，可查看物理机器详情，包括基本信息：物理机ID、物理机IPv4地址、物理机器IPv6地址、集群ID、Qemu版本、CPU类型、状态、总核数、已分配核数、总内存、已分配内存、更新时间。

同时可以查看物理机器的监控信息，包括：网卡入带宽、网卡出带宽、硬盘读吞吐、硬盘写吞吐、平均负载、内存使用率、空间使用率、硬盘读此书、网卡入包量、硬盘写次数、网卡出包量、CPU使用率、TCP连接数、阻塞进程数。

### 6.2 IP网段管理





### 6.1.3 物理机纳管



## 6.2 虚拟资源管理

### 6.2.1 虚拟机管理

支持管理员查看和管理平台所有的虚拟机。

###  6.2.2 虚拟机模版

支持管理员查看和管理平台所有的虚拟机模版。

### 6.2.3 网卡管理

支持管理员查看和管理平台所有的网卡。

### 6.2.4 VPC网路管理

支持管理员查看和管理平台所有的VPC网路。

### 6.2.5 外网IP管理

支持管理员查看和管理平台所有的外网IP。

### 6.2.6安全组管理

支持管理员查看和管理平台所有的安全组。

### 6.2.7负载均衡实例管理

支持管理员查看和管理平台所有的负载均衡实例。

### 6.2.8 NAT网关服务管理

支持管理员查看和管理平台所有的NAT网关服务。

### 6.2.9 硬盘管理

支持管理员查看和管理平台所有的硬盘。

#### 6.2.9.1 Qos设置

支持管理员管理硬盘的Qos设置。平台默认会为每块硬盘设置基础的Qos值，限制硬盘读/写IOPS 、读/写带宽。

![](volumeqos.png)

### 6.2.10 外置存储管理

支持管理员查看和管理平台所有的外置存储。

### 6.2.11 快照管理

支持管理员查看和管理平台所有的快照。

### 6.2.12Redis实例管理

支持管理员查看和管理平台所有的Redis实例。

### 6.2.13 MySQL实例管理

支持管理员查看和管理平台所有的MySQL实例。

# 7 租户管理

云平台支持多租户管理，对于有多级组织架构的企业，可以将租户作为一个单独的公司进行运营，可以有效实现权限管理，降低总公司和子公司，以及一个公司不同部门资源混用可能造成的风险，并可实现事后审计。

![](organazation.png)

概念解释：

- 租户： 组织是UCloudStack中的一组资源的集合，不同组织间的资源通过VPC、权限等实现强隔离。资源、费用、配额以及审批流程都归属于一个租户。一个租户必须有一个主账号，主账号默认有组织下所有资源的全部权限以及所有管理功能的权限。
- 账号
  - 主账号：主账号拥有操作租户中所有资源对象的权限以及租户内的管理操作。
  - 子账号：子账号是主账号创建的用户，子账号在租户下的权限由主账号控制。

## 7.1 查看租户列表

管理员可查看平台所有的账户列表。一个账户代表一个租户。在创建账号时，平台默认会创建一个租户和一个主账号，主账号即为此租户的管理者。账户的列表信息包括：

- 账户ID：租户的ID

- 账户邮箱：租户下主账号的邮箱

- 现金余额：租户的现金余额

- 赠送余额：租户的赠送余额

- 信用余额：租户的信用余额

- 状态：租户的可用状态

- 审批流程：租户是否设置了审批流程

- 自动审批：租户是否开启了自动审批

- 创建时间：租户的创建时间

## 7.2 创建账户

管理员可通过创建账户来新增平台的租户，创建账户时需要输入：

- 账户名称：主账户的名称标识

- 账户邮箱：主账户的邮箱
- 账户密码：主账户的登录密码
- 确认密码；再次确认主账号的登录密码
- 资源审批：是否需要为租户开启资源审批
- 自动审批：是否需要为租户开启资源的自动审批

创建后，将账号的邮箱和密码发送给最终用户，用户即可使用此账户登录云平台进行相关资源操作。

> 账户创建后余额默认为0，需要进入账户的充值管理页面，为账户充值后，用户才可正常创建和使用资源。

## 7.2 冻结账户

可使用冻结功能冻结主账户，冻结后，用户无法使用主账号的账号密码登录云平台。但租户内的资源依然正常运行，不会影响用户的业务。

## 7.3 登录限制

管理员可为主账号设置登录限制策略。登录访问策略决定可以登录控制台和访问API的客户端IP地址，配置后账号只能从指定的IP登录或发起API访问，默认不指定任何IP，代表不限制登录控制台和访问API的IP地址。

## 7.4 编辑审批流程

管理员可通过编辑审批流程管理租户下的审批流程设置。包括开启/关闭资源审批，开启/关闭自动审批。

## 7.5查看账户概览

点击账户名称或者目标账户右侧的“详情”按钮，可进入账户概览页面。账户概览页面主要展示账户的基本信息和账户下所有的成员。

基本信息包括；账户ID、账户邮箱、现金余额、赠送余额、信用余额、创建时间。

成员列表主要展示租户下的主账号和子账号信息。列表信息包括：

- 角色ID：主账号/子账号在平台的唯一标识

- 角色：账户的角色，分为主账号和子账号两种

- 账户ID：租户的ID

- 邮箱：账户的登录邮箱

- 状态：账户的状态

- 创建时间：账户的创建时间

## 7.6管理账户订单管理

切换到“订单管理”页面，通过自定义查询时间查看租户在一定时间周期内产生的订单。

##7.7 管理账户充值

切换到“充值管理”页面，通过自定义查询时间查看租户在一定时间周期内产生的充值记录。并可为租户充值，充值方式分为账户余额、免费账户余额两种，账户余额的充值涞源分为微信支付、银行转账、支付宝支付、微信支付、新浪支付五种。管理员可按照使用需求，为租户充值。

## 7.8 管理账户交易

切换到“交易管理”页面，通过自定义查询时间查看租户在一定时间周期内产生的交易记录。

## 7.9管理账户配额

切换到“配额管理”页面，可查看租户下现有产品的配额信息，同时可修改租户下每个产品的配额。

## 7.10 管理账户产品价格

切换到“价格管理”页面，可查看针对此租户的产品定价。并可以针对单个产品为此租户设置价格折扣，此租户只针对此租户生效。在云平台运营中，此功能可以满足针对不同客户类型，提供不同的云资源价格折扣的场景。

## 7.11 账户资源概览

切换到“资源概览”页面，可查看租户下的资源使用概况，包括CPU平均使用率、内存平均使用率、硬盘平均使用率、带宽平均使用率；以及租户下配额使用情况，包括虚拟机、镜像、硬盘、弹性网卡、VPC、外网弹性IP、安全组、负载均衡、NAT网关、VPN网关、MySQL、Redis的总配额以及已使用的配额情况。

# 8 审批管理

为了帮助企业优化云资源的管理流程，UcloudStack提供审批流程管理功能。当租户下设置了审批流程后，租户下的用户申请资源需要提出申请工单，只有当admin审批通过后，资源才会下发到租户。针对云资源使用需要走审批流程，但不需要人工介入审批的企业，也可以在为租户开启审批流程的同时，开启自动审批过程，此时租户下的资源申请依然会生成相应的审批流程。
目前支持审批流程的云资源操作包括：
创建云主机、创建云盘、创建私有网络、创建外网IP、创建负载均衡、虚拟机修改配置、虚拟机热升级、扩容根磁盘、扩容数据盘、调整带宽。

## 8.1租户审批流程管理

### 8.1.1 为租户开启审批流程

####8.1.1.1新创建的租户

在新建租户时，可以直接为租户开启审批流程，并设置开启自动审批。

![](approval.png)

####8.1.1.2 已创建的租户

已创建的租户如果需要设置审批流程，可在租户管理页面通过编辑审批流程操作设置审批流程。

###8.1.2查看租户审批流程

admin可在租户管理页面查看账户是否已设置审批流程，是否已开启自动审批。

###8.1.3 编辑租户审批流程

admin可在租户管理页面为租户编辑审批流程，包括为租户开启/关闭审批流程以及开启/关闭自动审批。

## 8.2 审批管理

### 8.2.1 查看审批管理记录

admin可在审批管理列表查看平台所有待办和已办审批记录。已办列表主要展示已由admin审批过的申请记录。代办列表展示尚未被审批的申请记录。审批记录列表包括以下信息：

- 申请名称：用户提交的申请名称。

- 资源类型：本次申请涉及到的资源类型。

- 操作：本次申请针对资源进行对操作。

- 账号邮箱：申请人的账户邮箱。

- 账户ID：申请人的账户ID。

- 创建时间：申请的创建时间。

- 审批结果：已办审批可查看审批结果，分为通过和拒绝两种情况。

### 8.2.2通过申请

admin可通过审批申请，通过后的申请将自动为申请租户执行资源操作，下发资源或者对资源执行变配操作。

### 8.2.3 拒绝申请

admin可拒绝审批申请，拒绝后的申请将直接结束流程，不再执行资源操作。

### 8.2.4 查看审批记录详情

点击审批记录右侧的详情按钮，可查看本条审批记录对应的申请详情，包括申请的基本信息、资源信息、关联资源以及处理记录。

# 9 账务管理

UcloudSatck为用户提供完整的平台财务管理能力，包括订单管理、交易管理、充值管理、价格配置四大模块。

- 订单管理：查看平台发生的所有订单记录，或者或者自定义查询时间段对订单记录进行查询。

- 交易管理：查看平台所有交易的扣费记录，或者自定义查询时间段对交易的扣费记录进行查询。

- 充值管理：查看平台所有的充值记录，或者自定义查询时间段对充值记录进行搜索。

- 价格配置：对平台售卖的云服务按照预定义的维度进行定价和定价修改。

## 9.1 订单管理

admin可在订单管理页面，通过自定义查询时间查看云平台在一定时间周期内产生的订单。订单列表包含以下信息：

- 订单号：订单在云平台的唯一标识。

- 资源ID：订单关联资源的资源ID。

- 订单类型：包括续费和新购两种。

- 订单金额：订单产生的金额。

- 创建时间：订单的发生时间。

## 9.2 交易管理

admin可在交易管理页面，通过自定义查询时间查看云平台在一定时间周期内产生的交易。交易列表包含以下信息：

- 交易单号：交易记录在云平台的唯一标识。

- 交易类型：账户充值和扣费均会生成一次交易记录，因此交易类型包括账户余额充值、免费账户充值、扣费三种。

- 账户ID：充值的账户ID。

- 账户名称：充值的账户名称。

- 支出：本次交易支出的费用。

- 收入：本次交易收入的费用。

- 账户余额：本次交易后账户余额。

- 免费余额：本次交易后账户的免费余额。

- 交易时间：本次交易产生的时间。

## 9.3 充值管理

admin可在充值管理页面，通过自定义查询时间查看云平台在一定时间周期内产生的充值记录。充值列表包含以下信息：

- 充值单号：充值记录在云平台的唯一标识。

- 充值帐户ID：充值的账号ID。

- 充值帐户名称：充值帐户名称。

- 充值邮箱：充值的账户邮箱。

- 充值渠道：充值的渠道。

- 充值方式：充值的金额类型，分为账户余额和免费账户余额。

- 充值金额：充值的金额数。

- 创建时间：充值产生的时间。

## 9.4 价格配置

### 9.4.1 定价

平台支持对6个维度的资源项进行定价，包括CPU、内存、硬盘、外网、GPU。单个云服务的实际出售价格，根据云服务所涉及到的计费资源项进行累加。

| 资源项 | 计费类型     | 计费规则                                     |
| ------ | ------------ | -------------------------------------------- |
| CPU    | 小时、月、年 | 每个集群每Core价格                           |
| 内存   | 小时、月、年 | 每个集群每G价格                              |
| 硬盘   | 小时、月、年 | 每个集群每GB价格                             |
| 外网IP | 小时、月、年 | 每个集群每Mb价格，可以定义带宽不同梯度的价格 |
| GPU    | 小时、月     | 每个集群每颗GPU价格                          |

> 平台在初始化时，会对所有计费项进行初始定价，如果需要修改可在管理平台/账务/价格配置中进行调整。如果平台不需要计费，可以将所有计费项的价格设置为0。

### 9.4.2 价格更新

资源项的小时定价被更新后，按小时的云服务将在下一个计费周期按照新价计算出最新价格并进行扣费。资源项的月、年价格的更新对于已经支付过的按月和按年云服务无影响。

# 10 平台配置

## 10.1全局配置

UclouStack平台支持十几种高级设置，管理员可以根据平台实际使用情况调整，具体介绍如下：

- 计费
  - 资源是否自动续费: 默认设置为是，开启后，当租户账户余额充足时，将自动对租户下已有的计费资源进行自动续费。关闭后，账户存在余额时，将不再对租户下资源进行自动续费。
- 控制台
  - 是否开启多次登录失败冻结账号：默认设置为否。开启后，输入密码错误5次并登陆失败，账号将被锁定。需要联系平台管理员解锁账号。
  - 是否开启90天强制修改密码：默认设置为否。开启后，每90天需要强制修改账户密码。
- 硬盘设置

  - 是否开启硬盘Qos：默认设置为是。平台针对硬盘将分配默认Qos限制规则，此配置开启后，针对硬盘设置的Qos才可以生效。如果整个平台不需要对硬盘进行Qos配置，可整体关闭硬盘Qos，关闭后，平台针对硬盘设置的Qos将不再生效。
- 邮箱设置：

  - 发件人邮箱地址: 配置发件人的邮箱地址

  - 发件人邮箱密码：配置发件人邮箱密码

  - 邮箱服务器IP: 设置发件邮箱的IP地址
  - 邮箱服务器Port：设置发件邮箱的Port
  - 邮箱主题前缀：配置平台发送的提醒邮件的主题前缀
- 网站设置：
  - 邮件主题前缀
  - 网站Favicon图片
  - 网站Title
  - 云平台Logo图片
- 网络设置
  - 内网带宽：设置内网带宽上限，管理员可根据平台自身内网带宽和带宽使用情况设置上限。
  - VPC网段：设置平台使用的VPC网段，默认为10.0.0.0/16,172.16.0.0/16,192.168.0.0/16，管理员可根据平台实际使用情况进行修改。
- 配额设置
  - 是否开启配额管理：设置平台是否需要开启配额管理，默认状态为开启。关闭后，租户创建资源时将不再受租户配额的限制，可以创建任意数量的资源。
  - 单个硬盘创建快照上限：设置单个硬盘创建快照的数量上限，默认为10个。管理员可根据平台实际使用情况调整上限数值。
- 回收策略
  - 回收站资源是否自动销毁：设置资源进入回收站后，是否在固定周期后销毁，默认为开启状态。如果实际使用中，没有自动销毁回收站资源的需求，可关闭此配置。
  - 回收站资源自动销毁周期：资源删除进入回收站后自动删除的周期。
  - 过期资源是否自动删除进回收站：开启后，虚拟机、云硬盘、外网IP等资源过期7天后被删除并进入回收站资。进入回收站时，虚拟机关联的资源将会被解绑。如果平台不需要自动将过期7天的虚拟机、云硬盘、外网IP删除进入回收站，可关闭此配置。
- 资源管理
  - 资源是否允许删除

## 10.2 规格配置

管理人员可以通过规格配置来调整云平台上架云产品的规格类型。云平台主要支持以下云服务的规格设置：

虚拟机、Redis、MySQL：硬盘、外网弹性IP。

### 10.2.1 虚拟机规格配置

虚拟机规格为平台支持售卖的虚拟机的规格类型，即用户在创建虚拟机时可选择的虚拟机规格。支持管理员对虚拟机规格进行创建、修改、删除。虚拟机规格相关参数包括：

- 产品：虚拟机规格对应的产品即为虚拟机

- 规格类型：虚拟机的规格包括CPU和内存两个参数，因此规格类型为CPU内存

- 集群类型：虚拟机规格对应的计算集群类型

- CPU：规格的CPU核数

- 内存：规格的内存容量

### 10.2.2 MySQL规格配置

MySQL规格定义平台Redis服务支持售卖的内存容量规格，即用户在创建MySQL服务时可选择的内存容量规格。支持管理员对MySQL规格进行创建、修改、删除。MySQL规格相关产品包括：

- 产品：MySQL规格对应的产品即为MySQL

- 规格类型：内存

- 集群类型：Redis规格对应的计算集群

- 内存：规格的内存容量

### 10.2.3 Redis规格配置

Redis 规格定义平台Redis服务支持售卖的内存容量规格，即用户在创建Redis服务时可选择的内存容量规格。支持管理员对Redis规格进行创建、修改、删除。Redis规格相关参数包括：

- 产品：Redis规格对应的产品即为Redis

- 规格类型：内存

- 集群类型：Redis规格对应的计算集群

- 内存：规格的内存容量

### 10.2.4 硬盘配置

硬盘规格为平台支持售卖的硬盘规格，即用户在创建硬盘时可设置的硬盘容量范围。每个已部署的存储集群数量对应一个默认硬盘规格条目。支持管理员对硬盘规格进行修改。硬盘规格相关参数包括：

- 产品：硬盘规格对应的产品即为硬盘

- 规格类型：硬盘规格对应的规格类型为容量范围

- 集群类型：硬盘规格对应的存储集群类型

- 最小容量：此硬盘规格允许创建的最小硬盘容量，数值范围10~8000GB

- 最大容量：此硬盘规格允许创建的最大硬盘容量，数值范围11~8000GB

### 10.2.5 外网弹性IP

外网弹性IP为平台支持售卖的外网弹性IP规格，即用户在创建外网IP时可设置的带宽范围。每个外网弹性IP网段对应一个默认的外网IP规格条目。支持管理员对外网IP规格进行修改。外网IP规格相关参数包括：

- 产品：外网IP规格对应的产品即为外网弹性IP

- 规格类型：带宽

- 集群类型：外网IP规格对应的外网IP网段

- 最小带宽：此弹性外网IP规格允许创建的最小带宽容量，数值必须大于1

- 最大带宽：此弹性外网IP规格允许创建的最大带宽容量，

## 10.3 配额管理

配额管理是提供给admin账户对于租户的资源总量进行整体控制的统一模版。每个新创建的租户会自动加上配额限制，默认配额限制即为配额管理页面的配额数量。

管理员可根据平台实际使用情况调整默认配额，调整后及时生效，平台所有已有租户的配额将按照新的配额标准执行，新创建的租户也会按照新的配额标准设置配额限制。

目前配额限制主要包括：VPN网关数量、MySQL数量、Redis数量、NAT网关数量、安全组数量、负载均衡数量、外网弹性IP数量、网卡数量、硬盘数量。

> 平台支持为单个租户调整配额，请参考7租户管理中关于调整租户配额部分的描述。

# 11 操作日志

管理员可在操作日志页面查看通过自定义查询时间查看云平台在一定时间周期内产生的操作日志，完成平台操作审计工作。并可在搜索框中根据操作（API名称）或者操作者查询相关操作日志。

# 12 监控大屏

点击管理员头像旁的屏幕按钮，即可查看云平台监控大屏。监控大屏主要展示展示平台宏观维度的监控数据，帮助企业云平台运营者快速了解平台的整体运行情况。监控大屏主要包含以下内容：

通知和告警：展示最近5条平台告警信息

物理机TOP5: 展示CPU使用率、硬盘读吞吐、硬盘写吞吐、内存使用率在前5名的物理节点IP

虚拟机TOP5: 展示CPU使用率、硬盘读吞吐、硬盘写吞吐、内存使用率在前5名的虚拟机ID

资源分配：展示云平台CPU、内存、存储的总容量以及已分配容量的百分比

资源概览：展示物理机总量以及状态分布（可用、锁定）、展示计算集群和存储集群的数量分布、展示虚拟机总量以及状态分布（运营、关机、其他）

![](moniterscreen.png)